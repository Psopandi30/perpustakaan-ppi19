import{j as e,X as y,B as p,P as w,D as k,l as B,T as C,E as P,J as L,K as S,x as T,N as D}from"./index-BJNlBc_g.js";import{r as u}from"./charts-vendor-DhOxG2_S.js";import{t as f}from"./date-Bvg2Sx2u.js";import{i as j,r as v}from"./file-C-CVBF3a.js";import"./react-vendor-Bzgz95E1.js";const G=({bulletin:r,onClose:c,onSave:d})=>{const[o,x]=u.useState({...r,tanggalTerbit:f(r.tanggalTerbit)}),[i,m]=u.useState(null);u.useEffect(()=>{x({...r,tanggalTerbit:f(r.tanggalTerbit)})},[r]);const g=t=>{const{name:a,value:l}=t.target;x(n=>({...n,[a]:l})),m(null)},h=t=>{if(t.preventDefault(),Object.values(o).some(a=>typeof a=="string"&&a.trim()==="")){m("Semua kolom wajib diisi.");return}d(o)},b=[{name:"judul",label:"Judul Buletin",type:"text"},{name:"namaPenulis",label:"Nama Penulis",type:"text"},{name:"tanggalTerbit",label:"Tanggal Terbit",type:"date"},{name:"drafLink",label:"Link Draf Google Drive",type:"text"}],s=async t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a){if(!j(a)){m("Format cover harus JPG atau PNG."),t.target.value="";return}try{const n=await v(a);x(N=>({...N,coverLink:n})),m(null)}catch{m("Gagal membaca file cover.")}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Edit Buletin"}),e.jsx("button",{onClick:c,"aria-label":"Close modal",children:e.jsx(y,{className:"h-6 w-6 text-gray-500 hover:text-gray-800"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[b.map(t=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:`edit-${t.name}`,className:"block text-sm font-medium text-gray-700 mb-1",children:t.label}),e.jsx("input",{type:t.type,id:`edit-${t.name}`,name:t.name,value:o[t.name],onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]},t.name)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Cover (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"}),o.coverLink&&e.jsx("img",{src:o.coverLink,alt:"Preview Cover",className:"mt-3 h-32 w-full object-cover rounded-md border"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Isi Buletin"}),e.jsx("textarea",{id:"edit-content",name:"content",value:o.content,onChange:g,rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),i&&e.jsx("p",{className:"text-red-500 text-sm",role:"alert",children:i}),e.jsxs("div",{className:"flex justify-end items-center pt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition-colors",children:"Simpan Perubahan"})]})]})]})})},E=({onClose:r,onSave:c})=>{const[d,o]=u.useState({judul:"",coverLink:"",drafLink:"",namaPenulis:"",tanggalTerbit:"",content:""}),[x,i]=u.useState(null),m=s=>{const{name:t,value:a}=s.target;o(l=>({...l,[t]:a})),i(null)},g=s=>{if(s.preventDefault(),Object.values(d).some(t=>typeof t=="string"&&t.trim()==="")){i("Semua kolom wajib diisi.");return}c(d)},h=[{name:"judul",label:"Judul Buletin",type:"text"},{name:"namaPenulis",label:"Nama Penulis",type:"text"},{name:"tanggalTerbit",label:"Tanggal Terbit",type:"date"},{name:"drafLink",label:"Link Draf Google Drive",type:"text"}],b=async s=>{var a;const t=(a=s.target.files)==null?void 0:a[0];if(t){if(!j(t)){i("Format cover harus JPG atau PNG."),s.target.value="";return}try{const l=await v(t);o(n=>({...n,coverLink:l})),i(null)}catch{i("Gagal membaca file cover.")}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Tambah Buletin"}),e.jsx("button",{onClick:r,"aria-label":"Close modal",children:e.jsx(y,{className:"h-6 w-6 text-gray-500 hover:text-gray-800"})})]}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[h.map(s=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:`add-${s.name}`,className:"block text-sm font-medium text-gray-700 mb-1",children:s.label}),e.jsx("input",{type:s.type,id:`add-${s.name}`,name:s.name,value:d[s.name],onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]},s.name)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Cover (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"}),d.coverLink&&e.jsx("img",{src:d.coverLink,alt:"Preview Cover",className:"mt-3 h-32 w-full object-cover rounded-md border"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"add-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Isi Buletin"}),e.jsx("textarea",{id:"add-content",name:"content",value:d.content,onChange:m,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),x&&e.jsx("p",{className:"text-red-500 text-sm",role:"alert",children:x}),e.jsxs("div",{className:"flex justify-end items-center pt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition-colors",children:"Simpan"})]})]})]})})},$=()=>{const[r,c]=u.useState([]),[d,o]=u.useState(!1),[x,i]=u.useState(null),[m,g]=u.useState(!0),h=async()=>{g(!0);try{const a=await P();c(a)}catch(a){console.error("Error loading bulletins:",a),c([])}finally{g(!1)}};u.useEffect(()=>{h()},[]);const b=async a=>{const l=await S(a);l?(c([l,...r]),o(!1),await T({type:"buletin",title:"Buletin Baru Tersedia!",message:`Buletin "${l.judul}" telah ditambahkan. Silakan baca sekarang!`,timestamp:new Date,isRead:!1})):alert("Gagal menambahkan buletin")},s=async a=>{window.confirm("Apakah Anda yakin ingin menghapus buletin ini?")&&(await L(a)?c(r.filter(n=>n.id!==a)):alert("Gagal menghapus buletin"))},t=async a=>{await D(a)?(c(r.map(n=>n.id===a.id?a:n)),i(null)):alert("Gagal mengupdate buletin")};return m?e.jsx("div",{className:"p-6 text-center",children:"Loading bulletins..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"h-8 w-8 text-dark-teal"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 uppercase tracking-wide",children:"DAFTAR BULETIN"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center bg-green-500 text-white font-bold py-2 px-4 rounded shadow hover:bg-green-600 transition-colors duration-300",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{className:"h-5 w-5"}),e.jsx(w,{className:"h-4 w-4"})]}),e.jsx("span",{className:"ml-2",children:"Tambahkan Buletin"})]})]}),e.jsx("div",{className:"flex-grow border-2 border-gray-300 rounded-lg overflow-hidden flex flex-col",children:e.jsx("div",{className:"border-2 border-gray-300 rounded-lg overflow-hidden",style:{maxHeight:"600px",overflow:"auto"},children:e.jsxs("table",{className:"min-w-full bg-white text-sm",children:[e.jsx("thead",{className:"bg-gray-100 border-b-2 border-gray-300 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600",children:"No"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600",children:"Judul Buletin"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600",children:"Tanggal terbit"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600",children:"Penulis"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600",children:"Cover Buletin"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600",children:"Link Draf Google Drive"}),e.jsx("th",{className:"px-4 py-3 w-24"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[r.map((a,l)=>{const n=k(a.coverLink);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-500",children:l+1}),e.jsx("td",{className:"px-4 py-3 font-medium text-green-700",children:a.judul}),e.jsx("td",{className:"px-4 py-3 text-gray-500",children:a.tanggalTerbit}),e.jsx("td",{className:"px-4 py-3 text-gray-500",children:a.namaPenulis}),e.jsx("td",{className:"px-4 py-3",children:n?e.jsx("img",{src:n,alt:`Cover ${a.judul}`,className:"h-16 w-12 object-cover rounded-md border"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Belum ada cover"})}),e.jsx("td",{className:"px-4 py-3 text-blue-600 hover:underline",children:e.jsx("a",{href:a.drafLink,target:"_blank",rel:"noopener noreferrer",children:"Link Buku Google Drive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>i(a),className:"text-black hover:text-gray-700",title:"Edit",children:e.jsx(B,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>s(a.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:e.jsx(C,{className:"h-5 w-5"})})]})})]},a.id)}),r.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"Tidak ada data buletin."})})]})]})})})]}),d&&e.jsx(E,{onClose:()=>o(!1),onSave:b}),x&&e.jsx(G,{bulletin:x,onClose:()=>i(null),onSave:t}),e.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 10px;
                    height: 10px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                    border-radius: 5px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #000;
                    border-radius: 5px;
                    border: 2px solid #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #555;
                }
            `})]})};export{$ as default};
