import{j as e,X as N,P as S,k as C,l as U,T as A,n as L,u as k,o as u,p as F,q as T}from"./index-RsgQjp0y.js";import{r as d}from"./charts-vendor-DhOxG2_S.js";import"./react-vendor-Bzgz95E1.js";const E=({onClose:r,onSave:l})=>{const[t,o]=d.useState({namaLengkap:"",status:"",alamat:"",telepon:"",username:"",password:"",akunStatus:"Aktif"}),[m,c]=d.useState(null),n=i=>{const{name:p,value:s}=i.target;o(h=>({...h,[p]:s})),c(null)},x=i=>{i.preventDefault();for(const p in t)if(t[p]===""){c("All fields are required.");return}l(t)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Tambah User Baru"}),e.jsx("button",{onClick:r,"aria-label":"Close modal",children:e.jsx(N,{className:"h-6 w-6 text-gray-500 hover:text-gray-800"})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"namaLengkap",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),e.jsx("input",{type:"text",id:"namaLengkap",name:"namaLengkap",value:t.namaLengkap,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{id:"status",name:"status",value:t.status,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"santri",children:"Santri"}),e.jsx("option",{value:"Asatidz",children:"Asatidz"}),e.jsx("option",{value:"Staf",children:"Staf"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"alamat",className:"block text-sm font-medium text-gray-700 mb-1",children:"Alamat"}),e.jsx("input",{type:"text",id:"alamat",name:"alamat",value:t.alamat,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telepon",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor WhatsApp"}),e.jsx("input",{type:"text",id:"telepon",name:"telepon",value:t.telepon,onChange:n,placeholder:"08xxxxxxxxxx",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username/NIS/NISN"}),e.jsx("input",{type:"text",id:"username",name:"username",value:t.username,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:t.password,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"akunStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Akun"}),e.jsxs("select",{id:"akunStatus",name:"akunStatus",value:t.akunStatus,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"Aktif",children:"Aktif"}),e.jsx("option",{value:"Tidak aktif",children:"Tidak aktif"})]})]}),m&&e.jsx("p",{className:"text-red-500 text-sm",role:"alert",children:m}),e.jsxs("div",{className:"flex justify-end items-center pt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition-colors",children:"Simpan"})]})]})]})})},D=({user:r,onClose:l,onSave:t})=>{const[o,m]=d.useState({...r,password:""}),[c,n]=d.useState(null);d.useEffect(()=>{m({...r,password:""})},[r]);const x=s=>{const{name:h,value:b}=s.target;m(f=>({...f,[h]:b})),n(null)},i=s=>{s.preventDefault();const{password:h,...b}=o;for(const j in b)if(b[j]===""){n("All fields except password are required.");return}const f={...o};o.password||(f.password=r.password),t(f)},p=[{name:"namaLengkap",label:"Nama Lengkap",type:"text"},{name:"status",label:"Status",type:"text"},{name:"alamat",label:"Alamat",type:"text"},{name:"telepon",label:"Telepon",type:"text"},{name:"username",label:"Username",type:"text"},{name:"password",label:"New Password (optional)",type:"password"}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Edit User"}),e.jsx("button",{onClick:l,"aria-label":"Close modal",children:e.jsx(N,{className:"h-6 w-6 text-gray-500 hover:text-gray-800"})})]}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[p.map(s=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:`edit-${s.name}`,className:"block text-sm font-medium text-gray-700 mb-1",children:s.label}),e.jsx("input",{type:s.type,id:`edit-${s.name}`,name:s.name,value:o[s.name]||"",onChange:x,placeholder:s.type==="password"?"Leave blank to keep current":"",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]},s.name)),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-akunStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Setatus Akun"}),e.jsxs("select",{id:"edit-akunStatus",name:"akunStatus",value:o.akunStatus,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"Aktif",children:"Aktif"}),e.jsx("option",{value:"Tidak aktif",children:"Tidak aktif"})]})]}),c&&e.jsx("p",{className:"text-red-500 text-sm",role:"alert",children:c}),e.jsxs("div",{className:"flex justify-end items-center pt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition-colors",children:"Simpan Perubahan"})]})]})]})})},z=()=>{const[r,l]=d.useState([]),[t,o]=d.useState(!1),[m,c]=d.useState(null),[n,x]=d.useState(!0),[i,p]=d.useState(""),s=async()=>{x(!0);try{const a=await L();l(a)}catch(a){console.error("Error loading users:",a),l([])}finally{x(!1)}};d.useEffect(()=>{s()},[]);const h=r.filter(a=>a.namaLengkap.toLowerCase().includes(i.toLowerCase())||a.username.toLowerCase().includes(i.toLowerCase())||a.status.toLowerCase().includes(i.toLowerCase())),b=async a=>{const g=await T(a);g?(l([...r,g]),o(!1),u.success("User berhasil ditambahkan.")):u.error("Gagal menambahkan user")},f=async a=>{await k(a)?(l(r.map(y=>y.id===a.id?a:y)),c(null),u.success("User berhasil diupdate.")):u.error("Gagal mengupdate user")},j=async a=>{window.confirm("Apakah Anda yakin ingin menghapus user ini?")&&(await F(a)?(l(r.filter(y=>y.id!==a)),u.success("User berhasil dihapus.")):u.error("Gagal menghapus user"))},v=async a=>{const g={...a,akunStatus:"Aktif"};await k(g)?(l(r.map(w=>w.id===a.id?g:w)),u.success("User berhasil disetujui.")):u.error("Gagal menyetujui user")};return n?e.jsx("div",{className:"p-6 text-center",children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md border border-gray-200 h-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b space-y-4 sm:space-y-0",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:"Kelola User Registrasi"}),e.jsxs("div",{className:"flex items-center space-x-4 w-full sm:w-auto",children:[e.jsx("input",{type:"text",placeholder:"Cari User...",value:i,onChange:a=>p(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 w-full sm:w-64"}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center bg-green-600 text-white font-bold py-2 px-4 rounded-full hover:bg-green-700 transition-colors duration-300 shadow whitespace-nowrap",children:[e.jsx(S,{className:"h-5 w-5 mr-2"}),"Tambah User Manual"]})]})]}),e.jsx("div",{className:"border-2 border-gray-300 rounded-lg overflow-hidden",style:{maxHeight:"600px",overflow:"auto"},children:e.jsxs("table",{className:"min-w-full bg-white text-sm",children:[e.jsx("thead",{className:"bg-gray-100 border-b-2 border-gray-300 sticky top-0 z-10",children:e.jsx("tr",{children:["Nama Lengkap","Status","Alamat","Telepon","Username","Status Akun","Konfirmasi"].map(a=>e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider bg-gray-100",children:a},a))})}),e.jsxs("tbody",{children:[h.map(a=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-700",children:a.namaLengkap}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:a.status}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:a.alamat}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:a.telepon}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:a.username}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full border ${a.akunStatus==="Aktif"?"bg-green-100 text-green-800 border-green-300":"bg-gray-100 text-gray-800 border-gray-300"}`,children:a.akunStatus})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>v(a),className:"text-green-500 hover:text-green-700","aria-label":"Confirm user",title:"Setujui",disabled:a.akunStatus==="Aktif",children:e.jsx(C,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(a),className:"text-blue-500 hover:text-blue-700","aria-label":"Edit user",title:"Edit",children:e.jsx(U,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>j(a.id),className:"text-red-500 hover:text-red-700","aria-label":"Delete user",title:"Delete",children:e.jsx(A,{className:"h-5 w-5"})})]})})]},a.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:i?"Tidak ada user yang ditemukan.":"Tidak ada data user."})})]})]})})]}),t&&e.jsx(E,{onClose:()=>o(!1),onSave:b}),m&&e.jsx(D,{user:m,onClose:()=>c(null),onSave:f})]})};export{z as default};
