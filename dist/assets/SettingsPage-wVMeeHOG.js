import{j as e,c as k,ar as S,as as G}from"./index-BJNlBc_g.js";import{r as l}from"./charts-vendor-DhOxG2_S.js";import{i as p,r as w}from"./file-C-CVBF3a.js";import"./react-vendor-Bzgz95E1.js";const K=()=>{const[t,i]=l.useState({libraryName:"",adminPassword:"",loginLogo:"",adminPhoto:""}),[u,r]=l.useState(null),[g,d]=l.useState(null),[m,y]=l.useState(!1),[f,h]=l.useState(""),[j,x]=l.useState(!0);l.useEffect(()=>{(async()=>{x(!0);const s=await S();i(s),x(!1)})()},[]);const b=a=>{const{name:s,value:o}=a.target;i(n=>({...n,[s]:o})),r(null),d(null)},N=async a=>{var o;const s=(o=a.target.files)==null?void 0:o[0];if(s){if(!p(s)){r("Format logo harus JPG atau PNG."),a.target.value="";return}if(s.size>200*1024){r("Ukuran logo terlalu besar. Maksimal 200KB."),a.target.value="";return}try{const n=await w(s);i(c=>({...c,loginLogo:n})),r(null)}catch{r("Gagal membaca file logo.")}}},P=async a=>{var o;const s=(o=a.target.files)==null?void 0:o[0];if(s){if(!p(s)){r("Format foto harus JPG atau PNG."),a.target.value="";return}if(s.size>200*1024){r("Ukuran foto terlalu besar. Maksimal 200KB."),a.target.value="";return}try{const n=await w(s);i(c=>({...c,adminPhoto:n})),r(null)}catch{r("Gagal membaca file foto.")}}},v=async a=>{if(a.preventDefault(),r(null),d(null),!t.libraryName.trim()){r("Nama perpustakaan wajib diisi.");return}if(t.adminPassword&&t.adminPassword!==f){r("Kata sandi baru dan konfirmasi tidak cocok.");return}await G(t)?(d("Pengaturan berhasil disimpan!"),h(""),setTimeout(()=>{window.location.reload()},1e3)):r("Gagal menyimpan pengaturan.")};return j?e.jsx("div",{className:"p-6",children:"Loading settings..."}):e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(k,{className:"h-8 w-8 text-dark-teal"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 uppercase tracking-wide",children:"PENGATURAN"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"libraryName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Perpustakaan"}),e.jsx("input",{type:"text",id:"libraryName",name:"libraryName",value:t.libraryName,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",placeholder:"PERPUSTAKAAN DIGITAL PPI 19 GARUT"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"adminPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Kata Sandi Admin Baru (kosongkan jika tidak ingin mengubah)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",id:"adminPassword",name:"adminPassword",value:t.adminPassword,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",placeholder:"Masukkan kata sandi baru"}),e.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700",children:m?"Sembunyikan":"Tampilkan"})]})]}),t.adminPassword&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Kata Sandi Baru"}),e.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:f,onChange:a=>h(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",placeholder:"Konfirmasi kata sandi baru"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo Login (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:N,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"}),t.loginLogo&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Preview Logo:"}),e.jsx("div",{className:"w-28 h-28 bg-white rounded-full flex items-center justify-center shadow-lg border-2 border-gray-200 overflow-hidden",children:e.jsx("img",{src:t.loginLogo,alt:"Logo Preview",className:"w-full h-full object-cover"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto Admin (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:P,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"}),t.adminPhoto&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Preview Foto:"}),e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center shadow-md border-2 border-gray-300 overflow-hidden",children:e.jsx("img",{src:t.adminPhoto,alt:"Foto Admin Preview",className:"w-full h-full object-cover"})})]})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",role:"alert",children:u}),g&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",role:"alert",children:g}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",className:"px-6 py-2 bg-dark-teal text-white font-semibold rounded-md hover:bg-teal-700 transition-colors",children:"Simpan Pengaturan"})})]})]})};export{K as default};
