import{j as e,c as k,aw as S,ax as L}from"./index-BiA865_u.js";import{r as i}from"./charts-vendor-DhOxG2_S.js";import{i as p,r as w}from"./file-C-CVBF3a.js";import"./react-vendor-Bzgz95E1.js";const F=()=>{const[a,l]=i.useState({libraryName:"",adminPassword:"",loginLogo:"",adminPhoto:""}),[g,o]=i.useState(null),[h,d]=i.useState(null),[c,y]=i.useState(!1),[f,x]=i.useState(""),[N,m]=i.useState(!0);i.useEffect(()=>{(async()=>{m(!0);const s=localStorage.getItem("literasi_settings");if(s){const t=JSON.parse(s);l(t)}else{const t=await S();l(t)}m(!1)})()},[]);const b=r=>{const{name:s,value:t}=r.target;l(n=>({...n,[s]:t})),o(null),d(null)},j=async r=>{var t;const s=(t=r.target.files)==null?void 0:t[0];if(s){if(!p(s)){o("Format logo harus JPG atau PNG."),r.target.value="";return}try{const n=await w(s);l(u=>({...u,loginLogo:n})),o(null),d("Logo berhasil diunggah!")}catch{o("Gagal membaca file logo.")}}},P=async r=>{var t;const s=(t=r.target.files)==null?void 0:t[0];if(s){if(!p(s)){o("Format foto harus JPG atau PNG."),r.target.value="";return}if(s.size>200*1024){o("Ukuran foto terlalu besar. Maksimal 200KB."),r.target.value="";return}try{const n=await w(s);l(u=>({...u,adminPhoto:n})),o(null)}catch{o("Gagal membaca file foto.")}}},v=async r=>{if(r.preventDefault(),o(null),d(null),!a.libraryName.trim()){o("Nama perpustakaan wajib diisi.");return}if(a.adminPassword&&a.adminPassword!==f){o("Kata sandi baru dan konfirmasi tidak cocok.");return}try{if(console.log("Saving settings:",a),m(!0),await L(a)){const t={libraryName:a.libraryName,adminPassword:a.adminPassword,loginLogo:a.loginLogo,adminPhoto:a.adminPhoto};localStorage.setItem("literasi_settings",JSON.stringify(t)),d("Pengaturan berhasil disimpan ke Database!"),x(""),window.dispatchEvent(new CustomEvent("settingsUpdated",{detail:t}))}else throw new Error("Gagal menyimpan ke database")}catch(s){console.error("Error saving settings:",s),o("Terjadi kesalahan saat menyimpan pengaturan. Pastikan koneksi internet stabil.")}finally{m(!1)}};return N?e.jsx("div",{className:"p-6",children:"Loading settings..."}):e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(k,{className:"h-8 w-8 text-dark-teal"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 uppercase tracking-wide",children:"PENGATURAN"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"libraryName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Perpustakaan"}),e.jsx("input",{type:"text",id:"libraryName",name:"libraryName",value:a.libraryName,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",placeholder:"PERPUSTAKAAN DIGITAL PPI 19 GARUT"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"adminPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Kata Sandi Admin Baru (kosongkan jika tidak ingin mengubah)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",id:"adminPassword",name:"adminPassword",value:a.adminPassword,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",placeholder:"Masukkan kata sandi baru"}),e.jsx("button",{type:"button",onClick:()=>y(!c),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700",children:c?"Sembunyikan":"Tampilkan"})]})]}),a.adminPassword&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Konfirmasi Kata Sandi Baru"}),e.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:f,onChange:r=>x(r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",placeholder:"Konfirmasi kata sandi baru"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo Login (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"}),a.loginLogo&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Preview Logo:"}),e.jsx("div",{className:"w-20 h-20 bg-white rounded-lg flex items-center justify-center shadow-md border border-gray-200 overflow-hidden",children:e.jsx("img",{src:a.loginLogo,alt:"Logo Preview",className:"w-full h-full object-cover"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto Admin (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:P,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"}),a.adminPhoto&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Preview Foto:"}),e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center shadow-md border-2 border-gray-300 overflow-hidden",children:e.jsx("img",{src:a.adminPhoto,alt:"Foto Admin Preview",className:"w-full h-full object-cover"})})]})]}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",role:"alert",children:g}),h&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",role:"alert",children:h}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",className:"px-6 py-2 bg-dark-teal text-white font-semibold rounded-md hover:bg-teal-700 transition-colors",children:"Simpan Pengaturan"})})]})]})};export{F as default};
