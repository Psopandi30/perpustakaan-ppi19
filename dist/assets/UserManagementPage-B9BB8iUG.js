import{j as e,X as v,y as S,z as C,D as A,J as U,K as L,T as I,N as T,u as k,O as h,V as F,Y as E}from"./index-CfBMCytT.js";import{r as l}from"./charts-vendor-DhOxG2_S.js";import"./react-vendor-Bzgz95E1.js";const P=({onClose:n,onSave:o})=>{const[r,a]=l.useState({namaLengkap:"",status:"",alamat:"",telepon:"",username:"",password:"",akunStatus:"Aktif"}),[c,u]=l.useState(!1),[f,m]=l.useState(null),t=p=>{const{name:i,value:b}=p.target;a(x=>({...x,[i]:b})),m(null)},d=p=>{p.preventDefault();for(const i in r)if(r[i]===""){m("All fields are required.");return}o(r)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Tambah User Baru"}),e.jsx("button",{onClick:n,"aria-label":"Close modal",children:e.jsx(v,{className:"h-6 w-6 text-gray-500 hover:text-gray-800"})})]}),e.jsxs("form",{onSubmit:d,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"namaLengkap",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),e.jsx("input",{type:"text",id:"namaLengkap",name:"namaLengkap",value:r.namaLengkap,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{id:"status",name:"status",value:r.status,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"Santri",children:"Santri"}),e.jsx("option",{value:"Asatidz",children:"Asatidz"}),e.jsx("option",{value:"Staf",children:"Staf"}),e.jsx("option",{value:"Tamu",children:"Tamu"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"alamat",className:"block text-sm font-medium text-gray-700 mb-1",children:"Alamat"}),e.jsx("input",{type:"text",id:"alamat",name:"alamat",value:r.alamat,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telepon",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor WhatsApp"}),e.jsx("input",{type:"text",id:"telepon",name:"telepon",value:r.telepon,onChange:t,placeholder:"08xxxxxxxxxx",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username/NISN/NIS/NIP/NIAT"}),e.jsx("input",{type:"text",id:"username",name:"username",value:r.username,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",id:"password",name:"password",value:r.password,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal pr-10"}),e.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none",children:c?e.jsx(S,{className:"h-5 w-5"}):e.jsx(C,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"akunStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Akun"}),e.jsxs("select",{id:"akunStatus",name:"akunStatus",value:r.akunStatus,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"Aktif",children:"Aktif"}),e.jsx("option",{value:"Tidak aktif",children:"Tidak aktif"})]})]}),f&&e.jsx("p",{className:"text-red-500 text-sm",role:"alert",children:f}),e.jsxs("div",{className:"flex justify-end items-center pt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition-colors",children:"Simpan"})]})]})]})})},D=({user:n,onClose:o,onSave:r})=>{const[a,c]=l.useState({...n,password:""}),[u,f]=l.useState(!1),[m,t]=l.useState(null);l.useEffect(()=>{c({...n,password:""})},[n]);const d=i=>{const{name:b,value:x}=i.target;c(y=>({...y,[b]:x})),t(null)},p=i=>{i.preventDefault();const{password:b,...x}=a;for(const w in x)if(x[w]===""){t("All fields except password are required.");return}const y={...a};a.password||(y.password=n.password),r(y)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Edit User"}),e.jsx("button",{onClick:o,"aria-label":"Close modal",children:e.jsx(v,{className:"h-6 w-6 text-gray-500 hover:text-gray-800"})})]}),e.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-namaLengkap",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),e.jsx("input",{type:"text",id:"edit-namaLengkap",name:"namaLengkap",value:a.namaLengkap,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{id:"edit-status",name:"status",value:a.status,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"Santri",children:"Santri"}),e.jsx("option",{value:"Asatidz",children:"Asatidz"}),e.jsx("option",{value:"Staf",children:"Staf"}),e.jsx("option",{value:"Tamu",children:"Tamu"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-alamat",className:"block text-sm font-medium text-gray-700 mb-1",children:"Alamat"}),e.jsx("input",{type:"text",id:"edit-alamat",name:"alamat",value:a.alamat,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-telepon",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telepon"}),e.jsx("input",{type:"text",id:"edit-telepon",name:"telepon",value:a.telepon,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username/NISN/NIS/NIP/NIAT"}),e.jsx("input",{type:"text",id:"edit-username",name:"username",value:a.username,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password (optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:u?"text":"password",id:"edit-password",name:"password",value:a.password,onChange:d,placeholder:"Leave blank to keep current",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal pr-10"}),e.jsx("button",{type:"button",onClick:()=>f(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none",children:u?e.jsx(S,{className:"h-5 w-5"}):e.jsx(C,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-akunStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Setatus Akun"}),e.jsxs("select",{id:"edit-akunStatus",name:"akunStatus",value:a.akunStatus,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-dark-teal",children:[e.jsx("option",{value:"Aktif",children:"Aktif"}),e.jsx("option",{value:"Tidak aktif",children:"Tidak aktif"})]})]}),m&&e.jsx("p",{className:"text-red-500 text-sm",role:"alert",children:m}),e.jsxs("div",{className:"flex justify-end items-center pt-4 space-x-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition-colors",children:"Simpan Perubahan"})]})]})]})})},q=()=>{const[n,o]=l.useState([]),[r,a]=l.useState(!1),[c,u]=l.useState(null),[f,m]=l.useState(!0),[t,d]=l.useState(""),p=async()=>{m(!0);try{const s=await T();o(s)}catch(s){console.error("Error loading users:",s),o([])}finally{m(!1)}};l.useEffect(()=>{p()},[]);const i=n.filter(s=>s.namaLengkap.toLowerCase().includes(t.toLowerCase())||s.username.toLowerCase().includes(t.toLowerCase())||s.status.toLowerCase().includes(t.toLowerCase())),b=async s=>{const g=await E(s);g?(o([...n,g]),a(!1),h.success("User berhasil ditambahkan.")):h.error("Gagal menambahkan user")},x=async s=>{await k(s)?(o(n.map(j=>j.id===s.id?s:j)),u(null),h.success("User berhasil diupdate.")):h.error("Gagal mengupdate user")},y=async s=>{window.confirm("Apakah Anda yakin ingin menghapus user ini?")&&(await F(s)?(o(n.filter(j=>j.id!==s)),h.success("User berhasil dihapus.")):h.error("Gagal menghapus user"))},w=async s=>{const g={...s,akunStatus:"Aktif"};await k(g)?(o(n.map(N=>N.id===s.id?g:N)),h.success("User berhasil disetujui.")):h.error("Gagal menyetujui user")};return f?e.jsx("div",{className:"p-6 text-center",children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md border border-gray-200 h-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b space-y-4 sm:space-y-0",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:"Kelola User Registrasi"}),e.jsxs("div",{className:"flex items-center space-x-4 w-full sm:w-auto",children:[e.jsx("input",{type:"text",placeholder:"Cari User...",value:t,onChange:s=>d(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 w-full sm:w-64"}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center bg-green-600 text-white font-bold py-2 px-4 rounded-full hover:bg-green-700 transition-colors duration-300 shadow whitespace-nowrap",children:[e.jsx(A,{className:"h-5 w-5 mr-2"}),"Tambah User Manual"]})]})]}),e.jsx("div",{className:"border-2 border-gray-300 rounded-lg overflow-hidden",style:{maxHeight:"600px",overflow:"auto"},children:e.jsxs("table",{className:"min-w-full bg-white text-sm",children:[e.jsx("thead",{className:"bg-gray-100 border-b-2 border-gray-300 sticky top-0 z-10",children:e.jsx("tr",{children:["Nama Lengkap","Status","Alamat","Telepon","Username/NISN/NIS/NIP/NIAT","Status Akun","Konfirmasi"].map(s=>e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider bg-gray-100",children:s},s))})}),e.jsxs("tbody",{children:[i.map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-700",children:s.namaLengkap}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:s.status}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:s.alamat}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:s.telepon}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:s.username}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full border ${s.akunStatus==="Aktif"?"bg-green-100 text-green-800 border-green-300":"bg-gray-100 text-gray-800 border-gray-300"}`,children:s.akunStatus})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>w(s),className:"text-green-500 hover:text-green-700","aria-label":"Confirm user",title:"Setujui",disabled:s.akunStatus==="Aktif",children:e.jsx(U,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>u(s),className:"text-blue-500 hover:text-blue-700","aria-label":"Edit user",title:"Edit",children:e.jsx(L,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>y(s.id),className:"text-red-500 hover:text-red-700","aria-label":"Delete user",title:"Delete",children:e.jsx(I,{className:"h-5 w-5"})})]})})]},s.id)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:t?"Tidak ada user yang ditemukan.":"Tidak ada data user."})})]})]})})]}),r&&e.jsx(P,{onClose:()=>a(!1),onSave:b}),c&&e.jsx(D,{user:c,onClose:()=>u(null),onSave:x})]})};export{q as default};
